apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: surfops-generate-poll
  namespace: default
  labels: &labels
    app: surfops
    component: cronjob
    env: production
    team: nextgen
spec:
  # At 10:30 on Tuesday.
  schedule: "30 10 * * 2"
  suspend: false
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: surfops-generate-poll
            image: andreffs/surfops:latest
            imagePullPolicy: Always
            args:
              - 'python'
              - 'surf.py'
              - 'generate-poll'
              - '--channel'
              - 'general'
            envFrom:
            - secretRef:
                name: surfops-secrets
            resources:
              limits:
                cpu: 300m
                memory: 1000Mi
              requests:
                cpu: 300m
                memory: 1000Mi
          restartPolicy: Never